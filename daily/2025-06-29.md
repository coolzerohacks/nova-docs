ğŸ› ï¸ Nova Development Reportâ€” 29 June 2025
ğŸ¯ Focus Areas Today

    Reduced Nova's message repetition

    Added general light control across rooms

    Fixed group light naming for Home Assistant

    Confirmed working live web search integration

ğŸ” Message Repetition Reduction
âœ… Changes Implemented

    Added build_nova_redundancy_guard(memory) in message_guard.py:

        Detects repeated phrases in the last 4 Nova messages

        Blocks Nova from reusing or rephrasing them

    Updated build_mistral_prompt() to inject nova_redundancy_guard:

        Prevents repeated statements like "they're always competitive"

        Keeps dialogue moving forward

ğŸ”§ Prompt Construction Now Includes:

â™» Nova, youâ€™ve said the following lines multiple times:
- â€œthey're pretty competitiveâ€
- â€œMcLaren lets them race freelyâ€
- â€œgrab some snacks and watch togetherâ€

- Do NOT say these again or rephrase them.
- Provide new observations or move the conversation forward instead.

ğŸ’¡ Generalized Light Control
âœ… Refactor Summary

    Created handle_light_control(user_input, action="turn_on") in intent_handlers.py

    Accepts any room from a predefined map:

ROOM_LIGHT_MAP = {
    "office": "light.office_light",
    "bedroom": "light.bedroom_light",  # corrected 'lights' â†’ 'light'
    "kitchen": "light.kitchen_light"
}

Replaced handle_turn_on and handle_turn_off with:

    intent_handlers = {
        "turn_on": lambda input: handle_light_control(input, action="turn_on"),
        "turn_off": lambda input: handle_light_control(input, action="turn_off"),
        ...
    }

ğŸ§ª Confirmed Working

    Nova correctly turns on/off:

        office_light

        bedroom_light (via corrected entity name)

    Verified through logs and HA state tracking

ğŸŒ Live Web Search
âœ… Live Search Flow Operational

    Nova recognized live_web_search intent

    Fetched current F1 updates

    Referenced real-time snippets in response

    Prefixed responses with ğŸŒ for clarity

ğŸ§¼ File Cleanup & Structure

    intent_handlers.py: now holds all handle_... logic

    ha_services.py: now limited to low-level service calls only

    Removed accidental duplicate definitions

ğŸ”„ Cron Job Recovery & Validation

We reviewed, repaired, and manually tested all of Novaâ€™s scheduled tasks. Hereâ€™s the full list:
ğŸŸ© Repaired + Validated

    generate_diary.py
    â†³ Fixed working directory, added shebang, made executable

    weekly_backup.sh
    â†³ Rebuilt script to rsync full system to SSD with cron-safe checks

    snapshot-all-nova.sh
    â†³ Rebuilt script to snapshot running containers, rotate backups every 4 weeks

    f1_sync.py
    â†³ Validated, fixed path issues, confirmed data pull from Formula1.com

    f1_ingest.py
    â†³ Fixed execution method, tested data ingest successfully

    news_rss_ingest.py
    â†³ Confirmed working, added proper execution method

    compress_memory_facts.py
    â†³ Tested and confirmed memory summary processing

    push_daily_backup.sh
    â†³ Confirmed Git commit/push of recent changes, fixed .rasa/cache warning

    gpu_heartbeat.py
    â†³ Rebuilt script to log GPU usage via nvidia-smi, outputs JSON to logs

    txt_to_yaml.py
    â†³ Confirmed successful conversion of .txt to .yaml files

    yaml_uploader.py
    â†³ Confirmed file ingestion and cleanup logic

ğŸ›  Filesystem & Mounting Fixes

    Cleaned and corrected SSD mount path to /mnt/sda1

    Updated /etc/fstab with correct UUID

    Set ownership of SSD to user (coolzerohacks) for cron compatibility

ğŸ§¹ Directory & Script Cleanup

    Removed broken knowledge directory

    Replaced with valid structure from nova-setup-old

Novaâ€™s cron system is now:

    Fully repaired

    Scripts properly executable

    Logs clean and verifiable

    Mounted storage stable
